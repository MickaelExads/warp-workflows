---
name: Composer json symlinky
command: "cd /vagrant/code\n\n# Ask the user which replacement they want to perform\necho \"Which action would you like to perform?\"\necho \"0) Rollback all changes\"\necho \"1) Replace both exads-common and phpincludes\"\necho \"2) Replace only exads-common\"\necho \"3) Replace only phpincludes\"\nread -p \"Enter the number of your choice: \" choice\n\n# List of folders to search in\nFOLDERS=(\n    \"adrepository\"\n    \"ads\"\n    \"docs-api-swagger\"\n    \"docs-network-api-swagger\"\n    \"ecadmin\"\n    \"exads-common\"\n    \"exads-core\"\n    \"gateway\"\n    \"jobs\"\n    \"kantox-sdk-guzzle5\"\n    \"management\"\n    \"misc\"\n    \"php-huffman\"\n    \"phpincludes\"\n    \"push-notifications\"\n    \"rtb\"\n    \"static\"\n    \"syndication\"\n    \"www-api-exads/v2\"\n    \"www-network-api-exads/v1\"\n)\n\n# Function to replace exads-common\nreplace_exads_common() {\n    sed -i ':a;N;$!ba;s#\"type\": *\"vcs\",[[:space:]]*\"url\": *\"ssh://git@github.com/exads/exads-common\"#\"type\": \"path\",\\n            \"url\": \"/vagrant/code/exads-common\"#g' \"$1\"\n    sed -i 's#\"exads/exads-common\": \"\\*\"#\"exads/exads-common\": \"dev-master\"#g' \"$1\"\n}\n\n# Function to rollback exads-common replacement\nrollback_exads_common() {\n    sed -i ':a;N;$!ba;s#\"type\": \"path\",[[:space:]]*\"url\": \"/vagrant/code/exads-common\"#\"type\": \"vcs\",\\n            \"url\": \"ssh://git@github.com/exads/exads-common\"#g' \"$1\"\n    sed -i 's#\"exads/exads-common\": \"dev-master\"#\"exads/exads-common\": \"\\*\"#g' \"$1\"\n}\n\n# Function to replace phpincludes\nreplace_phpincludes() {\n    sed -i ':a;N;$!ba;s#\"type\": *\"vcs\",[[:space:]]*\"url\": *\"ssh://git@github.com/exads/phpincludes\"#\"type\": \"path\",\\n            \"url\": \"/vagrant/code/phpincludes\"#g' \"$1\"\n    sed -i 's#\"exads/phpincludes\": \"\\*\"#\"exads/phpincludes\": \"dev-master\"#g' \"$1\"\n}\n\n# Function to rollback phpincludes replacement\nrollback_phpincludes() {\n    sed -i ':a;N;$!ba;s#\"type\": \"path\",[[:space:]]*\"url\": \"/vagrant/code/phpincludes\"#\"type\": \"vcs\",\\n            \"url\": \"ssh://git@github.com/exads/phpincludes\"#g' \"$1\"\n    sed -i 's#\"exads/phpincludes\": \"dev-master\"#\"exads/phpincludes\": \"\\*\"#g' \"$1\"\n}\n\n# Loop through the listed folders\nfor folder in \"${FOLDERS[@]}\"; do\n    # Check if composer.json exists directly in the folder\n    if [ -f \"$folder/composer.json\" ]; then\n        echo \" \"\n        echo \"Processing $folder/composer.json...\"\n        \n        # Based on the user's choice, run the corresponding actions\n        if [ \"$choice\" == \"0\" ]; then\n            # Rollback all changes\n            rollback_exads_common \"$folder/composer.json\"\n            rollback_phpincludes \"$folder/composer.json\"\n        elif [ \"$choice\" == \"1\" ]; then\n            # Replace both exads-common and phpincludes\n            replace_exads_common \"$folder/composer.json\"\n            replace_phpincludes \"$folder/composer.json\"\n        elif [ \"$choice\" == \"2\" ]; then\n            # Replace only exads-common\n            replace_exads_common \"$folder/composer.json\"\n        elif [ \"$choice\" == \"3\" ]; then\n            # Replace only phpincludes\n            replace_phpincludes \"$folder/composer.json\"\n        else\n            echo \"Invalid choice. Skipping $folder/composer.json.\"\n        fi\n\n        echo \"Finished processing $folder/composer.json\"\n    else\n        echo \"No composer.json found in $folder.\"\n    fi\ndone\n\necho \"All folders processed!\"\n"
description: ~
arguments: []
tags: []
source_url: ~
author: ~
author_url: ~
shells: []
